# 谁是卧底 - 多智能体对战 (Node.js 版)

**重要提示：本项目绝大部分代码由大语言模型生成，作者本人无法保证项目整体的安全性、可靠性，代码极大概率存在安全漏洞。因此，我强烈建议，本项目应仅用于个人娱乐用，务必不要将其用于更加严肃的场合内！！！**

本项目通过 Web 界面实时展示多个 AI 智能体进行“谁是卧底”游戏的完整过程，包括每轮的发言、投票和最终的游戏结果。

## 一、 主要功能

-   **全自动游戏流程**：程序启动后，AI 玩家会自动完成发言、投票、淘汰等所有游戏环节，直至分出胜负。
-   **动态AI交互**：每个 AI 玩家都会根据场上已有的发言历史来组织自己的描述，并基于所有人的发言进行分析和投票。
-   **实时战况直播**：游戏日志、玩家发言和投票理由会通过流式传输实时显示在前端页面上，方便观察战局。
-   **上帝视角**：前端页面提供“上帝视角”开关，开启后可以查看所有玩家的身份（平民/卧底）和他们拿到的具体词语。
-   **动态淘汰机制**：每轮投票后，得票最多的玩家会被淘汰出局。
-   **灵活配置**：用户可以在前端自由设定游戏的总人数、卧底数量和最大回合数。

## 二、 如何运行

#### 1. 克隆或下载仓库

将项目文件下载到本地。

#### 2. 安装依赖

确保你已经安装了 [Node.js](https://nodejs.org/) (建议 v16 或更高版本)。然后在项目根目录下打开终端，运行以下命令：

```bash
npm install
```

#### 3. 配置 API 密钥

a. 本项目默认连接字节跳动[火山引擎](https://www.volcengine.com/)的[豆包大模型](https://www.volcengine.com/product/doubao)，因其 API 与 OpenAI 兼容。您也可以使用任何其他兼容 OpenAI 接口的 API 服务。请自行前往服务商处生成 API 密钥。

b. 在项目根目录下，复制 `api_env.env.sample` 文件并重命名为 `api_env.env` (如果示例文件不存在，请手动创建)。

c. 在新建的 `api_env.env` 文件中，添加你的 API 密钥，格式如下：

   ```
   ARK_API_KEY="YOUR_API_KEY_HERE"

   例如:
   ARK_API_KEY="111_222_333"
   ```

d. **（重要！）** 为了防止密钥泄露，`.gitignore` 文件已将 `api_env.env` 排除，请确保该文件不会被上传到 Git 仓库。

#### 4. 启动后端服务

运行 Node.js 应用：

```bash
npm start
```

终端会显示服务已在 `http://localhost:5000` 启动。

#### 5. 打开前端页面

在你的网页浏览器中，访问 `http://localhost:5000` 即可开始游戏。

## 三、 文件结构

-   `server.js`: Express.js 后端服务器，处理所有游戏逻辑和 AI 通信。
-   `package.json`: 项目依赖和脚本配置。
-   `public/index.html`: 游戏的前端界面。
-   `api_env.env`: 存储你的 API 密钥 (需自行创建)。
-   `README.md`: 本说明文件。

## 四、 前端页面示例

![示例图片](/sample_pic/sample_2.png)